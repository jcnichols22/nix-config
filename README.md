# nix-config

🌱 **Josh’s NixOS configuration** — declarative, flake-powered system & user config using [NixOS](https://nixos.org), [flakes](https://nixos.wiki/wiki/Flakes), and [Home Manager](https://nix-community.github.io/home-manager/).  
Designed for reproducibility, portability, and clean separation of system and user packages.

---

## 📁 Directory Structure

```
nix-config/
├── flake.nix # Entry point for system + home-manager configuration
├── flake.lock # Pinned input versions (auto-generated)
├── nixos/
│ ├── configuration.nix # System-level configuration
│ └── hardware-configuration.nix # Auto-generated by nixos-generate-config
└── home/
└── josh/
└── home.nix # Home Manager config for user josh
```



---

## 🚀 Features

- ✅ System managed with [flakes](https://nixos.wiki/wiki/Flakes)
- ✅ Declarative user configuration with Home Manager
- ✅ Git as the single source of truth for system state
- ✅ Flake-pinned inputs for deterministic builds
- ✅ Clean separation between system-wide and user-specific packages

---

## ⚙️ Usage

### 🔧 NixOS Rebuild (System + User)

```
sudo nixos-rebuild switch --flake ~/nix-config#nixos
```


> `#nixos` refers to the system identifier set in `flake.nix`

### 👤 Home Manager (User Only)

```
home-manager switch
```


> Only needed if you're managing Home Manager outside of the system config (not required in this case).

---

## 🔄 Updating Flake Inputs

To update all flake inputs (like `nixpkgs`, `home-manager`, etc.):

```
cd ~/nix-config
nix flake update
git add flake.lock
git commit -m "Update flake inputs"
```



---

## 🧰 Useful Commands

| Task                 | Command                                           |
|----------------------|---------------------------------------------------|
| Apply system config  | `sudo nixos-rebuild switch --flake .#nixos`       |
| Apply user config    | `home-manager switch`                             |
| Update inputs        | `nix flake update`                                |
| See activation diff  | `nixos-rebuild dry-activate --flake .#nixos`      |

---

## 🛠 What's Configured?

### System Packages (`configuration.nix`)

- Core tools: `vim`, `wget`, etc.
- GUI: KDE Plasma 6
- Audio: Pipewire
- Network: Tailscale, NetworkManager
- Boot: systemd-boot on UEFI
- Service: openssh

### User Packages (`home.nix`)

Used in Home Manager config for user `josh`:

- 🧠 Obsidian
- 🔐 1Password UI
- 🧑‍💻 VSCode, Git
- 🌐 Brave browser
- 💻 Waveterm
- 🧩 Bash aliases
- 📝 Git global config (`user.name`, `user.email`, aliases)

---

## ⚠️ Notes

- ❗ Ensure you’ve enabled flakes & nix-command Nix-wide. In your `configuration.nix`:

```
nix.settings.experimental-features = [ "nix-command" "flakes" ];
```


- 📝 Only files tracked by Git are included in the flake. After editing or adding new files, always run:

```
git add .
```


---

## 🧠 Future Ideas

- [ ] Manage dotfiles with `home.file`
- [ ] Secrets management with `agenix` or `sops-nix`
- [ ] Multi-system (laptop/server/etc) configuration via `nixosConfigurations`
- [ ] Modular system profiles (`./modules/common.nix`, `desktop.nix`, etc.)

---

## 📚 Resources

- 📘 [NixOS Manual](https://nixos.org/manual/nixos/stable/)
- 🏡 [Home Manager Manual](https://nix-community.github.io/home-manager)
- 🧊 [Nix Flakes Wiki](https://nixos.wiki/wiki/Flakes)
- 🎓 [Zero to Nix](https://zero-to-nix.com)

---